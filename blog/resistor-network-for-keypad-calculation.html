<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2R87B0XZCL"></script><script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){
          dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'G-2R87B0XZCL');
      </script><title>Calculating resistor networks for keypad applications | Rsomething <Personal Blog/></title><meta name="description" content="Rsomething's Personal Blog">
    <link rel="modulepreload" href="/assets/app.b78311c0.js"><link rel="modulepreload" href="/assets/resistor-network-for-keypad-calculation.html.20f5eb2b.js"><link rel="modulepreload" href="/assets/resistor-network-for-keypad-calculation.html.e81bdf62.js"><link rel="prefetch" href="/assets/index.html.3c2c7787.js"><link rel="prefetch" href="/assets/a-new-start.html.3bfc6d59.js"><link rel="prefetch" href="/assets/implementing-go-style-struct-tags-part-1.html.ac12148f.js"><link rel="prefetch" href="/assets/setjmp-longjmp-in-c-part-1.html.ad726d0c.js"><link rel="prefetch" href="/assets/implementing-another-socket-library-in-cpp-part-1.html.b0bc5e2e.js"><link rel="prefetch" href="/assets/implementing-another-socket-library-in-cpp-part-2.html.f66f073f.js"><link rel="prefetch" href="/assets/implementing-another-socket-library-in-cpp-part-3.html.3df8be2d.js"><link rel="prefetch" href="/assets/implementing-go-style-struct-tags-part-2.html.34d7b5dc.js"><link rel="prefetch" href="/assets/user-defined-literals-in-cpp.html.45c96f36.js"><link rel="prefetch" href="/assets/linear-algebra-the-basics.html.50f1004d.js"><link rel="prefetch" href="/assets/how-to-calculate-motor-rating-for-mobile-robots.html.95bd3b74.js"><link rel="prefetch" href="/assets/404.html.ce538133.js"><link rel="prefetch" href="/assets/index.html.e5d2d16e.js"><link rel="prefetch" href="/assets/index.html.3f8b9b2e.js"><link rel="prefetch" href="/assets/index.html.f3db06eb.js"><link rel="prefetch" href="/assets/index.html.1f2ed00a.js"><link rel="prefetch" href="/assets/a-new-start.html.e4a43ea9.js"><link rel="prefetch" href="/assets/implementing-go-style-struct-tags-part-1.html.becae05c.js"><link rel="prefetch" href="/assets/setjmp-longjmp-in-c-part-1.html.ae103e32.js"><link rel="prefetch" href="/assets/implementing-another-socket-library-in-cpp-part-1.html.836fbdc8.js"><link rel="prefetch" href="/assets/implementing-another-socket-library-in-cpp-part-2.html.81a6540d.js"><link rel="prefetch" href="/assets/implementing-another-socket-library-in-cpp-part-3.html.5a22ca0c.js"><link rel="prefetch" href="/assets/implementing-go-style-struct-tags-part-2.html.6ecd0592.js"><link rel="prefetch" href="/assets/user-defined-literals-in-cpp.html.45d8872f.js"><link rel="prefetch" href="/assets/linear-algebra-the-basics.html.b7018bf4.js"><link rel="prefetch" href="/assets/how-to-calculate-motor-rating-for-mobile-robots.html.6c049e21.js"><link rel="prefetch" href="/assets/404.html.9aff8135.js"><link rel="prefetch" href="/assets/index.html.899f9ecc.js"><link rel="prefetch" href="/assets/index.html.29881b68.js"><link rel="prefetch" href="/assets/index.html.841a157d.js"><link rel="prefetch" href="/assets/404.4e9d3fdf.js"><link rel="prefetch" href="/assets/CategoriesLayout.9e31fe91.js"><link rel="prefetch" href="/assets/HomeLayout.bd71f3b3.js"><link rel="prefetch" href="/assets/Layout.ea5b662c.js"><link rel="prefetch" href="/assets/PostLayout.162cfa7c.js"><link rel="prefetch" href="/assets/PostsLayout.decfb82f.js"><link rel="prefetch" href="/assets/SearchLayout.4e333fe7.js"><link rel="prefetch" href="/assets/TagsLayout.0715536d.js">
    <link rel="stylesheet" href="/assets/style.cec478b6.css">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><header class="theme-header"><a href="/" class="logo-link" style=""><!----><strong class="title">Rsomething &lt;Personal Blog/&gt;</strong></a><!----><nav class="navbar"><i class="iconfont icon-menu menu-btn"></i><ul class="nav-list"><li class="nav-item"><div class="navbar-blogger"><div class="avatar"><img src="/images/avatar.jpg" alt="Avatar" title="Avatar"></div><div class="types"><a href="/categories/?category=all" class="type"><span class="text">Categories</span><span class="num">11</span></a><div class="divider"></div><a href="/tags/?tag=all" class="type"><span class="text">Tags</span><span class="num">13</span></a></div><div class="blogger"><div class="name">Rsomething</div><p class="slogan" title="Personal Blog And Programming Notes.">Personal Blog And Programming Notes.</p></div></div></li><!--[--><!--]--><li class="nav-link nav-item animate__animated animate__slideInRight"><button class="theme-toggle"><i class="icon-sun iconfont"></i></button></li><li class="nav-link nav-item animate__animated animate__slideInRight search-link"><a href="/search/" class="navbar-item"><i class="icon-search iconfont"></i><span class="text">Search</span></a></li><li class="nav-item nav-medias animate__animated animate__slideInRight"><div class="medias"><!--[--><a class="icon-email iconfont" href="mailto:rkm7232@gmail.com" title="email" target="_blank"></a><a class="icon-github iconfont" href="https://github.com/the-this-pointer/" title="github" target="_blank"></a><a class="icon-book iconfont" href="https://the-this-pointer.github.io/my-resume/" title="book" target="_blank"></a><!--]--></div></li></ul></nav></header><main class="theme-container theme-post-container"><div class="theme-content post-container"><div class="post-wrapper"><i class="iconfont icon-book toc-btn"></i><i class="iconfont icon-menu aside-btn"></i><div class="markdown-body"><h1 class="post-title"><span>Calculating resistor networks for keypad applications</span></h1><div class="post-info"><span class="post-info-item"><i class="iconfont icon-avatar" title="Author"></i> Rsomething</span><span class="post-info-item"><i class="iconfont icon-datetime" title="Date"></i> 2024-07-19</span><span class="post-info-item"><i class="iconfont icon-categorynormal" title="Categories"></i><!--[--><a href="/categories/?category=Embedded" class="post-type">Embedded</a><!--]--></span><span class="post-info-item"><i class="iconfont icon-tag" title="Tags"></i><!--[--><a href="/tags/?tag=mathematics" class="post-type">mathematics</a><a href="/tags/?tag=programming" class="post-type">programming</a><!--]--></span></div><div><p>When I needed to manage more than 20 switches in one of my electronic projects, I chose resistor networks over the row-column method for reading the switches</p><p>Here is the essential calculation for the resistor network.</p><p>To keep this article concise, I will mention some useful links I found helpful:</p><ul><li><a href="http://www.lispology.com/show?10QY" target="_blank" rel="noopener noreferrer">This one<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> which is the main article (the one that inspired me) and use a <code>LISP</code> program to calculate the optimal solution.</li><li><a href="https://www.purchiaroni.com/progetti/Matrix/Matrix.html" target="_blank" rel="noopener noreferrer">The old one<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> which is in Italian and includes great details about the problem, the writer used an executable tool available for download.</li></ul><p>Both links indicate that their tools can take days or hours to complete the calculations. While time should not be an issue with today&#39;s computers, I wanted to rewrite the tool, I don&#39;t use LISP personally or executables I&#39;ve found on the Internet.</p><h2 id="explaination" tabindex="-1"><a class="header-anchor" href="#explaination" aria-hidden="true">#</a> Explaination</h2><p>To avoid reinventing the wheel, I initially began studying the LISP program. In this section, I will explain my observations from the code; feel free to skip it if you have already read the links above.</p><p>The tool applies a brute-force approach to evaluate the resistor values, to find the maximum of the smallest gaps across various resistor combinations. and there is no limit in the source code for cases where resistors have equal values. For example, when <code>d</code> and <code>e</code> are equal, it is impossible to determine whether switch <code>S2</code> or switch <code>S5</code> is pressed. Similarly, you cannot use a resistor value in the columns if it has already been used in the rows. Please remember that <code>a</code> is not either the column resistor or the row resistor.</p><br><p align="center"><img src="/assets/matrix.14663b47.png"></p><p>In the image above, when the <code>S16</code> switch is pressed the analog value connects to GND and the minimum value corresponds to this switch. The highest value is when all resistors (<code>a</code> is always in the path) are in the path which means the <code>S1</code> switch is pressed.</p><p>At first glance the minimmum gap for the ADC values is where the smallest resistor in the network comes to the path when all other resistors in the other side are already in the path. The resistors are shown in the image below. But literally the minimum gap can be because of adding/removing a column resistor to/from the path and removing/adding another row resistor in a way that the value difference was small, in this case the gap would be small if the <code>a</code> resistor is big enough.</p><p align="center"><img src="/assets/matrix_min_gap.b8bff0bc.png"></p><p>I have also gathered insights from previous work, such as the limitations of the ADC sampling rate due to output impedance. Additionally, you can multiply the values by a consistent factor. Now we can go further and implement the calculator.</p><h2 id="implementation" tabindex="-1"><a class="header-anchor" href="#implementation" aria-hidden="true">#</a> Implementation</h2><p>I have used the genetic algorithm to solve the problem, this can significantly improve the time efficiency, but it comes with caveats regarding precision and convergence. It guarantees that the final result is close enough to the exact solution but it may not be the solution you looking for. I also performed some tests on it and I figured out it may require thousands of generations to achieve a slight improvement in the best answer.</p><p>You can find my code in <a href="https://github.com/the-this-pointer/resistor-network-calculator" target="_blank" rel="noopener noreferrer">this Github repository<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div></div><div class="theme-divider"></div><div class="giscus-comment"><!----></div></div><div class="card-box card-wrapper post-tocs"><header><h3 class="title"><i class="iconfont icon-categorynormal"></i><span> Contents </span></h3></header><nav class="vuepress-toc"><ul class="vuepress-toc-list"><li class="vuepress-toc-item"><a aria-current="page" href="/blog/resistor-network-for-keypad-calculation.html#explaination" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="Explaination">Explaination</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/blog/resistor-network-for-keypad-calculation.html#implementation" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="Implementation">Implementation</a><!--[--><!--]--></li></ul></nav></div></div></main><footer class="theme-footer theme-common-footer"><div class="copyright"><a class="beian" href="https://the-this-pointer.github.io">With ❤️ From Iran</a><span class="delimiter">|</span><span class="info">Copyright © 2022-2024 Rsomething &lt;Personal Blog/&gt;</span></div></footer><div style="display:none;" class="back-to-top"><i class="iconfont icon-back-to-top"></i></div><!--]--><!--]--></div>
    <script type="module" src="/assets/app.b78311c0.js" defer></script>
  </body>
</html>
